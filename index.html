<!DOCTYPE html>
<html lang="ja">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-J7T83K9467"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'G-J7T83K9467');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SyFu Payment Matcher</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div class="card main-card">
            <div class="header-row">
                <div class="header-titles">
                    <h1 class="title">SyFu Payment Matcher</h1>
                    <p class="subtitle">決済データのBINDに最適な組み合わせを見つけよう</p>
                </div>
                <button onclick="openSettingsModal()" class="btn-settings" title="設定">⚙️</button>
            </div>

            <!-- タブ管理 -->
            <div class="tabs-container">
                <div class="tabs-header">
                    <div id="tabsList" class="tabs-list">
                        <!-- タブがここに表示される -->
                    </div>
                    <button onclick="addNewTab()" class="btn-add-tab" title="新しいタブを追加">+</button>
                </div>
            </div>

            <!-- タブコンテンツ -->
            <div id="tabContent">
                <div class="grid">
                    <!-- 左側: 決済データ一覧 -->
                    <div class="section">
                        <div class="payment-list-section">
                            <label class="label">決済データ一覧</label>
                            <div class="payment-list" id="paymentList">
                                <!-- 決済データがここに表示される -->
                            </div>
                        </div>

                        <div class="add-payment-section">
                            <label class="label">新しい決済データを追加</label>
                            <div class="form-group">
                                <input 
                                    type="text" 
                                    id="paymentName" 
                                    placeholder="決済名（例：ランチ代、書籍購入）"
                                    class="input"
                                >
                                <div class="input-row">
                                    <input 
                                        type="number" 
                                        id="paymentAmount" 
                                        placeholder="金額 (¥)"
                                        class="input"
                                    >
                                    <input 
                                        type="date" 
                                        id="paymentDate"
                                        class="input"
                                    >
                                </div>
                            </div>
                            <button onclick="addPayment()" class="btn btn-primary">
                                + 決済データを追加
                            </button>
                        </div>
                    </div>

                    <!-- 右側: 検索 -->
                    <div class="section">
                        <div class="target-section">
                            <label class="label">目標金額 ($)</label>
                            <input 
                                type="number" 
                                id="targetAmount" 
                                value="50"
                                class="input target-input"
                            >
                        </div>

                        <button onclick="findCombinations()" class="btn btn-search" id="searchBtn">
                            🔍 最適な組み合わせを検索
                        </button>

                        <div id="searchTime" class="search-info" style="display: none;">
                            ⓘ 検索時間: <span id="timeValue">0</span>ms
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 検索結果 -->
        <div id="resultsSection" class="card results-card" style="display: none;">
            <h2 class="results-title">検索結果 <span class="results-subtitle">(上位10件)</span></h2>
            <div id="resultsList" class="results-list">
                <!-- 検索結果がここに表示される -->
            </div>
        </div>
    </div>

    <!-- タブ名変更モーダル -->
    <div id="renameModal" class="modal" style="display: none;">
        <div class="modal-content">
            <h3 class="modal-title">タブ名を変更</h3>
            <input type="text" id="renameInput" class="input" placeholder="タブ名を入力">
            <div class="modal-buttons">
                <button onclick="confirmRename()" class="btn btn-primary">変更</button>
                <button onclick="closeRenameModal()" class="btn btn-secondary">キャンセル</button>
            </div>
        </div>
    </div>

    <!-- 設定モーダル -->
    <div id="settingsModal" class="modal" style="display: none;">
        <div class="modal-content settings-modal-content">
            <h3 class="modal-title">設定</h3>
            <div class="settings-list">
                <div class="settings-item">
                    <div class="settings-label">
                        <span class="settings-name">小数点切り上げ</span>
                        <span class="settings-description">USD換算時に小数点を切り上げる</span>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="roundUpEnabled" onchange="updateSettings()">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                <div class="settings-item">
                    <div class="settings-label">
                        <span class="settings-name">SyFu Pass 適用</span>
                        <span class="settings-description">合計金額に+20%が加算されます</span>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="syFuPassEnabled" onchange="updateSettings()">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>
            <div class="modal-buttons">
                <button onclick="closeSettingsModal()" class="btn btn-primary">閉じる</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
